import re
def Pow(x,y):
    if type(x) == type([]):
        exp = [x[0]**y, {}]
        for unit in x[1]:
            exp[1][unit] = exp[1][unit] ** y
        return exp  
    else:
        return x**y
convTable = {

   #Distance
   ('m'):       (1.,{'m':1}),
   ('cm'):      (1/100.,{'m':1}),
   ('mm'):      (1/1000., {'m':1}),
   ('km'):      (1/0.001, {'m':1}),
   ('feet'):    (1/3.2808399, {'m':1},'m'),
   ('foot'):    (1/3.2808399, {'m':1}),
   ('in'):      (1/0.0254, {'m':1}),
   ('inch'):    (1/0.0254, {'m':1}),
   ('inches'):  (1/0.0254, {'m':1}),
   ('smoot'):   (1/1.7018, {'m':1}),
   ('smoots'):  (1/1.7018, {'m':1}),
   ('mile'):    (1/1609.344, {'m':1}),
   ('miles'):   (1/1609.344, {'m':1}),
   ('ly'):      (1.05702341*Pow(10, 16), {'m':1}),
   ('lightyear'):  (1.05702341*Pow(10, 16), {'m':1}),
   ('lightyears'): (1.05702341*Pow(10, 16), {'m':1}),
   ('AU'):         (6.68458134*Pow(10,12), {'m':1}),

   #Weight
   ('g'):       (1.,{'g':1}),
   ('gram'):    (1.,{'g':1}),
   ('grams'):   (1.,{'g':1}),
   ('kg'):      (1/0.001,{'g':1}),
   ('lb'):      (1/0.00220462262,{'g':1}),
   ('lbs'):     (1/0.00220462262,{'g':1}),
   ('pound'):   (1/0.00220462262,{'g':1}),
   ('pounds'):  (1/0.00220462262,{'g':1}),

   ('acre'):    (4046.85642,{'m':2}),
   ('acres'):   (4046.85642,{'m':2}),

   #Time
   ('s'):       (1., {'s':1}),
   ('sec'):     (1.,{'s':1}),
   ('secs'):    (1.,{'s':1}),
   ('second'):  (1.,{'s':1}),
   ('seconds'): (1.,{'s':1}),
   ('min'):     (60.,{'s':1}),
   ('minute'):  (60.,{'s':1}),
   ('minutes'): (60.,{'s':1}),
   ('h'):       (3600.,{'s':1}),
   ('hour'):    (3600.,{'s':1}),
   ('hours'):   (3600.,{'s':1}),
   ('day'):     (86400.,{'s':1}),
   ('days'):    (86400.,{'s':1}),
   ('year'):    (31556926.,{'s':1}),
   ('years'):   (31556926.,{'s':1}),

   #Volume
   ('l'):        (0.001, {'m':3}),
   ('a cup'):    (0.000236588238,{'m':3}),
   ('a cups'):   (0.000236588238,{'m':3}),
   ('cup'):      (0.000236588238,{'m':3}),
   ('cups'):     (0.000236588238,{'m':3}),
   ('L'):        (0.001, {'m':3}),
   ('liter'):    (0.001, {'m':3}),
   ('liters'):   (0.001, {'m':3}),
   ('Liter'):    (0.001, {'m':3}),
   ('Liters'):   (0.001, {'m':3}),
   ('teaspoon'): (4.92892161*Pow(10,-6), {'m':3}),
   ('teaspoons'):(4.92892161*Pow(10,-6), {'m':3}),
   ('kilderkin'): (0.0818296538,{'m':3}),
   ('kilderkins'):(0.0818296538,{'m':3}),
   ('pint'):      (0.000473176475,{'m':3}),
   ('pints'):     (0.000473176475,{'m':3}),
   ('fl oz'):     (2.95735297*Pow(10,-5),{'m':3}),

   #Speed
   ('mph'):   (0.44704,{'m':1, 's':-1}),
   ('c'):     (299792458.,{'m':1, 's':-1}),
   ('knot'):  (0.514444444,{'m':1, 's':-1}),
   ('knots'): (0.514444444,{'m':1, 's':-1}),

   #Energy
   ('J'):        (1.,{'J':1}),
   ('Joule'):    (1.,{'J':1}),
   ('Joules'):   (1.,{'J':1}),
   ('joule'):    (1.,{'J':1}),
   ('joules'):   (1.,{'J':1}),
   ('cal'):      (4.18400,{'J':1}),
   ('calorie'):  (4.18400,{'J':1}),
   ('calories'): (4.18400,{'J':1}),
   ('Cal'):      (4.18400,{'J':1}),
   ('Calorie'):  (4.18400,{'J':1}),
   ('Calories'): (4.18400,{'J':1}),

   ('W'):        (1., {'J':1,'s':-1}),
   ('Watt'):     (1., {'J':1,'s':-1}),
   ('Watts'):    (1., {'J':1,'s':-1}),
}

def Convert(From,To):
    result = [From[0],{}]
    convertedUnits = {}
    for unit in To[1]:
        print unit
        conv = convTable[unit]
        result[0] *= 1/conv[0] # multiply coeffient
         
        print "Conv",conv
        for u in conv[1]:                #get meters, sec
            convertedUnits[u] = conv[1][u]   
        
        for i in range(len(conv)):
            if i > 1:
                temp = conv[i]
                result[1][unit] = From[1][temp]

    if convertedUnits != From[1]:
        print "Mismatch: Can't convert"
        print "From units:", convertedUnits
        print "To units:", From[1]
        
    else:
        print "Result:",result
    
a = [1, {'m': 1, 's':-1}]
b = [10, {'feet': 2,'hour':-1}]

print "From:", a
print "To:",b[1]
print "***********"
Convert(a,b)